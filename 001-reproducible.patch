This patch makes the build more reproducible, by:
 - Passing the -n flag to gzip to prevent it from saving the filename/timestamp
 - Adding support for the $SOURCE_DATE_EPOCH variable to override the current datetime

Originally from: https://github.com/crosstool-ng/crosstool-ng/pull/784/files

diff --git a/Makefile.in b/Makefile.in
index 0f32064a2..2b77d5d33 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -177,7 +177,7 @@ build-doc:
 build-man: docs/$(PROG_NAME).1.gz
 
 docs/$(PROG_NAME).1.gz: docs/$(PROG_NAME).1
-	$(call __silent,GZIP)gzip -c9 $< >$@
+	$(call __silent,GZIP)gzip -c9n $< >$@
 
 define sed_it
 	$(call __silent,SED,$@)$(sed) -r                    \
diff --git a/configure.ac b/configure.ac
index 4f7d3d328..010c2e0f2 100644
--- a/configure.ac
+++ b/configure.ac
@@ -424,9 +424,13 @@ AC_SEARCH_LIBS(
 # Lastly, take care of crosstool-NG internal values
 #--------------------------------------------------------------------
 # Hey! We need the date! :-)
-AC_SUBST(
-    [DATE],
-    [$(date +%Y%m%d)])
+DATE_FMT="%Y%m%d"
+if test "x$SOURCE_DATE_EPOCH" = "x"; then
+    DATE=$(date "+$DATE_FMT")
+else
+    DATE="$(date -u -d "@$SOURCE_DATE_EPOCH" "+$DATE_FMT" 2>/dev/null || date -u -r "$SOURCE_DATE_EPOCH" "+$DATE_FMT" 2>/dev/null || date -u "+$DATE_FMT")"
+fi
+AC_SUBST([DATE])
 
 # Decorate the version string if needed
 AS_IF(
